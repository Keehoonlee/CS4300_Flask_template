<!DOCTYPE html>
<html>
<head>
  <title> Foodicity </title>


  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <!--
  Import
  -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link href="{{url_for('static', filename='style.css')}}" rel="stylesheet">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

  <link rel="shortcut icon" type="image/x-icon" href="{{url_for('static', filename='image/iconletter.png')}}">
</head>

<body>
  <!-- <nav class="navbar navbar-inverse navbar-fixed-top" style="background: #FFFFFF; border: none; height: 70px; opacity:0.9;">
    <div class="nav-container">
      <div class="navbar-header">
        <a class="navbar-brand" onclick='history.back(-1)'>
          <img src="{{url_for('static', filename='image/icon.png')}}" alt="asdf">
        </a>
      </div>
    </div>
  </nav>
  <div style="height:70px;"> </div> -->

  <a class="navbar-brand" onclick='history.back(-1)'>
    <img src="{{url_for('static', filename='image/icon.png')}}" alt="asdf">
  </a> <br /><br /><br /><br />

  <div class="text-center">
    <font size="5" color="black" face="Arial Black">SEARCHED </font> <br />
    <font size="4" color="grey" face="Courier New">CITY: </font>
    <font size="3" color="black" face="Courier New">{{city}} </font> <br />
    <font size="4" color="grey" face="Courier New">NEIGHBORHOOD: </font>
    <font size="3" color="black" face="Courier New">{{neighborhood}} </font> <br />
    <font size="4" color="grey" face="Courier New">DATE POSTED: </font>
    <font size="3" color="black" face="Courier New">{% if time == "0" %} All Reviews {% else %} upto {{time}} months old {% endif %}</font> <br />
    <font size="4" color="grey" face="Courier New">CREDIBILITY: </font>
    <font size="3" color="black" face="Courier New">{{credibility}} </font> <br /><br /><br />
  </div>

  <div class="container-fluid" id="output">
    <div class="row">
      <br/>

      <div class="col-md-6">
          <canvas id="pie-chart" width="600" height="400" style='display: block;margin: auto;'>
      </div>

      <div class="col-md-6">
        <div class="panel panel-default">
          <div class="panel-heading" id="top-popular-heading"><font size="2" color="grey" face="Courier New"><center>Click One of the Categories to Display Information</center></font></div>
          <div class="panel-body" >
            <div class="pos_neg_chart">
              <canvas id="pie-chart_pos_neg"  style="display: block; margin: auto; width: 1%; height: 1%"></canvas>
            </div>
            <br />
            <p class="text-center"><font size="2" color="grey" face="Courier New"> Top popular restaurants </font></p>
            <div id="top-popular-body">
              <p class="text-center"><font size="2" color="black" face="Courier New"> No Information to Show </font></p>
            </div>

            <p class="text-center"><font size="2" color="grey" face="Courier New"> Least popular restaurants </font></p>
            <div id="bottom-popular-body">
              <p class="text-center"><font size="2" color="black" face="Courier New"> No Information to Show </font></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div><br/>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <script src="{{url_for('static', filename='main.js')}}" type="text/javascript"></script>
  <script>

  var canvas_all = document.getElementById("pie-chart");
  var ctx = canvas_all.getContext("2d");

  var all_chart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: [{% for item in labels %}
                  "{{item}}",
               {% endfor %}],
      datasets: [{
        label: "Percentage",
        backgroundColor: ["#F48B8B", "#F8A451", "#F9F274", "#C7E753", "#84EB7B", "#67E4DD", "#84CEF9", "#84AEF9", "#C58AF1", "#EE7AA4","#C58AF1", "#EE7AA4","#C58AF1", "#EE7AA4"],
        data:[{% for item in data %} "{{item}}", {% endfor %}]
      }]
    },
    options: {
      title: {
        display: true,
        text: 'Percentages per Category',
        fontSize: 14
      },
      responsive: false
    }
  });

<<<<<<< HEAD
  // new Chart(document.getElementById("pie-chart_pos_neg"), {
  //   type: 'pie',
  //   data: {
  //     labels: [{% for item in labels_pos %}
  //                 "{{item}}",
  //              {% endfor %}],
  //     datasets: [{
  //       label: "Percentage",
  //       backgroundColor: ["#1B4F72", "#21618C", "#2874A6", "#2E86C1", "#3498DB", "#5DADE2", "#85C1E9", "#AED6F1", "#D6EAF8", "#EBF5FB", "#D6EAF8", "EBF5FB", "#D6EAF8", "EBF5FB"],
  //       data:[{% for item in data_pos %} "{{item}}", {% endfor %}]
  //     }]
  //   },
  //   options: {
  //     title: {
  //       display: true,
  //       text: 'Positive vs Negative Reviews',
  //       fontSize: 14
  //     }
  //   }
  // });

  canvas_all.onclick = function(evt) {
    var activePoints = all_chart.getElementsAtEvent(evt);
    if (activePoints[0]) {
      var chartData = activePoints[0]['_chart'].config.data;
      var idx = activePoints[0]['_index'];

      var label = chartData.labels[idx];
      var value = chartData.datasets[0].data[idx];

      var pos_neg_percentages = {{pos_neg_percentages_per_category}}

      var text_heading = '<center><font size="4" color="grey" face="Courier New">CATEGORY: </font>' + '<font size="3" color="black" face="Courier New">'+ label +'</font></center>';
      $("#top-popular-heading").html(text_heading);

      $("#pie-chart_pos_neg").remove();
      $("div.pos_neg_chart").append('<canvas id="pie-chart_pos_neg" style="display: block; margin: auto; width: auto; height: auto"></canvas>');
      var ctx = document.getElementById("pie-chart_pos_neg").getContext("2d");
      var pos_neg_chart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ["Positive", "Negative"]
          // [{% for item in labels_pos %}
          //             "{{item}}",
          //          {% endfor %}]
          ,
          datasets:
          [{
            label: "Percentage",
            backgroundColor: ["#F48B8B", "#85C1E9"],
            data: [pos_neg_percentages[idx][0], pos_neg_percentages[idx][1]]
          }]
        },
        options: {
          title: {
            display: true,
            text: 'Positive vs Negative',
            fontSize: 12
          }
        }
      });

      var restaurants_infos_per_category = {{restaurants_infos_per_category}};
      var text_body_for_top = "{% for restaurant,star,address in restaurants_infos_per_category[labels[0].lower()][0] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}";
      // if (idx == 0) {
      //   {% if labels|length >=0 %}
      //     text_body_for_top ='{% for restaurant,star,address in restaurants_infos_per_category[labels[0].lower()][0] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
      //   {% endif %}
      // } else if (idx == 1 ) {
      //   {% if labels|length >=1 %}
      //     text_body_for_top ='{% for restaurant,star,address in restaurants_infos_per_category[labels[1].lower()][0] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
      //   {% endif %}
      // } else if (idx == 2) {
      //   {% if labels|length >=2 %}
      //     text_body_for_top ='{% for restaurant,star,address in restaurants_infos_per_category[labels[2].lower()][0] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
      //   {% endif %}
      // } else if (idx == 3) {
      //   {% if labels|length >=3 %}
      //     text_body_for_top ='{% for restaurant,star,address in restaurants_infos_per_category[labels[3].lower()][0] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
      //   {% endif %}
      // } else if (idx == 4) {
      //   {% if labels|length >=4 %}
      //     text_body_for_top ='{% for restaurant,star,address in restaurants_infos_per_category[labels[4].lower()][0] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
      //   {% endif %}
      // }

      $("#top-popular-body").html(text_body_for_top);

      var text_body_for_bot = "";
      if (idx == 0) {
        {% if labels|length >=0 %}
          text_body_for_bot ='{% for restaurant,star,address in restaurants_infos_per_category[labels[0].lower()][1] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
        {% endif %}
      } else if (idx == 1 ) {
        {% if labels|length >=1 %}
          text_body_for_bot ='{% for restaurant,star,address in restaurants_infos_per_category[labels[1].lower()][1] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
        {% endif %}
      } else if (idx == 2) {
        {% if labels|length >=2 %}
          text_body_for_bot ='{% for restaurant,star,address in restaurants_infos_per_category[labels[2].lower()][1] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
        {% endif %}
      } else if (idx == 3) {
        {% if labels|length >=3 %}
          text_body_for_bot ='{% for restaurant,star,address in restaurants_infos_per_category[labels[3].lower()][1] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
        {% endif %}
      } else if (idx == 4) {
        {% if labels|length >=4 %}
          text_body_for_bot ='{% for restaurant,star,address in restaurants_infos_per_category[labels[4].lower()][1] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} {{star}}</center> <center>{{address}}</center> </br></font> {% endfor %}';
        {% endif %}
=======
  new Chart(document.getElementById("pie-chart_pos_neg"), {
    type: 'pie',
    data: {
      labels: [{% for item in labels_pos %}
                  "{{item}}",
               {% endfor %}],
      datasets: [{
        label: "Percentage",
        backgroundColor: ["#1B4F72", "#21618C", "#2874A6", "#2E86C1", "#3498DB", "#5DADE2", "#85C1E9", "#AED6F1", "#D6EAF8", "#EBF5FB", "#D6EAF8", "EBF5FB", "#D6EAF8", "EBF5FB"],
        data:[{% for item in data_pos %} "{{item}}", {% endfor %}]
      }]
    },
    options: {
      title: {
        display: true,
        text: 'Positive vs Negative Reviews',
        fontSize: 14
>>>>>>> 85e88be2006f4081082b4810413aef55dded672f
      }

<<<<<<< HEAD
      $("#bottom-popular-body").html(text_body_for_bot);
=======
  canvas_all.onclick = function(evt) {
    var activePoints = all_chart.getElementsAtEvent(evt);
    if (activePoints[0]) {
      var chartData = activePoints[0]['_chart'].config.data;
      var idx = activePoints[0]['_index'];

      var label = chartData.labels[idx];
      var value = chartData.datasets[0].data[idx];

      var text_heading = '<font size="2" color="grey" face="Courier New"><center>Top 5 Restaurants for ' + label;
      $("#top-popular-heading").html(text_heading);

      $("#pie-chart_pos_neg").remove();
      $("div.pos_neg_chart").append('<canvas id="pie-chart_pos_neg" style="display: block; margin: auto; width: 50%; height: auto"></canvas>');
      var ctx = document.getElementById("pie-chart_pos_neg").getContext("2d");
      var pos_neg_chart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ["Positive", "Negative"]
          // [{% for item in labels_pos %}
          //             "{{item}}",
          //          {% endfor %}]
          ,
          datasets:
          [{
            label: "Percentage",
            backgroundColor: ["#F48B8B", "#85C1E9"],
            data: ["55", "45"]//[{% for item in data_pos %} "{{item}}", {% endfor %}]
          }]
        },
        options: {
          title: {
            display: true,
            text: 'Positive vs Negative Reviews',
            fontSize: 14
          }
        }
      });



      var text_body = "";
      if (idx == 0) {
        {% if labels|length >=0 %}
          text_body ='{% for restaurant in top_rest[labels[0].lower()] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} ★★★★☆</center> <center>Address : Hi, Ithaca, NY</center> </br></font> {% endfor %}';
        {% endif %}
      } else if (idx == 1 ) {
        {% if labels|length >=1 %}
          text_body ='{% for restaurant in top_rest[labels[1].lower()] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} ★★★★☆</center> <center>Address : Hi, Ithaca, NY</center> </br></font> {% endfor %}';
        {% endif %}
      } else if (idx == 2) {
        {% if labels|length >=2 %}
          text_body ='{% for restaurant in top_rest[labels[2].lower()] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} ★★★★☆</center> <center>Address : Hi, Ithaca, NY</center> </br></font> {% endfor %}';
        {% endif %}
      } else if (idx == 3) {
        {% if labels|length >=3 %}
          text_body ='{% for restaurant in top_rest[labels[3].lower()] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} ★★★★☆</center> <center>Address : Hi, Ithaca, NY</center> </br></font> {% endfor %}';
        {% endif %}
      } else if (idx == 4) {
        {% if labels|length >=4 %}
          text_body ='{% for restaurant in top_rest[labels[4].lower()] %} <font size="2" color="black" face="Courier New"><center>{{restaurant}} ★★★★☆</center> <center>Address : Hi, Ithaca, NY</center> </br></font> {% endfor %}';
        {% endif %}
      }



      $("#top-popular-body").html(text_body);
>>>>>>> 85e88be2006f4081082b4810413aef55dded672f
    }
  };


  </script>

</body>

</html>
